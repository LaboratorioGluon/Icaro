<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Redirecting...</title>
        <script>
            (function () {
                // Get base site URL dynamically (works in local & deployed environments)
                const siteUrl =
                    window.location.origin +
                    window.location.pathname.replace(/\/$/, ""); // Remove trailing slash

                // Define a mapping of language codes to URLs
                const languageMap = {
                    en: `${siteUrl}/en/`,
                    es: `${siteUrl}/es/`,
                };

                // Function to get the user's language preference
                function getUserLanguage() {
                    return (
                        navigator.language ||
                        navigator.userLanguage ||
                        "en"
                    ).split("-")[0]; // Default to 'en'
                }

                // Determine redirect URL
                const redirectUrl =
                    languageMap[getUserLanguage()] || languageMap["en"]; // Fallback to English if not mapped

                // Update fallback link before redirection
                document.addEventListener("DOMContentLoaded", () => {
                    const redirectLink =
                        document.getElementById("redirect-link");
                    if (redirectLink) redirectLink.href = redirectUrl;
                });

                // Perform redirection
                window.location.replace(redirectUrl);
            })();
        </script>
    </head>
    <body>
        <p>
            If you are not redirected automatically, redirect to:
            <a id="redirect-link" href="#">en</a>.
        </p>
    </body>
</html>
